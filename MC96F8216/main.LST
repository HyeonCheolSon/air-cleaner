C51 COMPILER V9.60.0.0   MAIN                                                              08/11/2021 17:30:44 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE main.c LARGE OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          //======================================================
   2          // Main program routine
   3          // - Device name  : MC96F8216
   4          // - Package type : 24QFN
   5          //======================================================
   6          // For XDATA variable : V1.041.00 ~
   7          #define   MAIN  1
   8          
   9          // Generated    : Wed, Aug 11, 2021 (12:44:11)
  10          #include  "MC96F8316.h"
  11          #include  "func_def.h"
  12          
  13          unsigned int i;
  14          unsigned int p;
  15          unsigned int count;
  16          unsigned int period;
  17          
  18          ////////////PWM////////////////
  19          void controlPWM(int num)
  20          {
  21   1        if(num == 0)
  22   1        {
  23   2          T0DR = 0xFF;
  24   2        }
  25   1        else if(num == 1)
  26   1        {
  27   2          T0DR = 0x80;
  28   2        }
  29   1        else if(num == 2)
  30   1        {
  31   2          T0DR = 0x40;
  32   2        }
  33   1        else if(num == 3)
  34   1        {
  35   2          T0DR = 0x01;
  36   2        }
  37   1      }
  38          //////////////////////////////////
  39          
  40          /////////////////////LED////////////
  41          void onRED()
  42          {
  43   1        offBLUE();
  44   1        offGREEN();
  45   1        P1 |= 0x02;
  46   1      
  47   1      }
  48          void offRED()
  49          {
  50   1        P1 &= 0xFD;
  51   1      }
  52          void onGREEN()
  53          {
  54   1        offBLUE();
  55   1        offRED();
C51 COMPILER V9.60.0.0   MAIN                                                              08/11/2021 17:30:44 PAGE 2   

  56   1        P1 |= 0x04;
  57   1      }
  58          void offGREEN()
  59          {
  60   1        P1 &= 0xFB;
  61   1      }
  62          void onBLUE()
  63          {
  64   1        offRED();
  65   1        offGREEN();
  66   1        P1 |= 0x08;
  67   1      }
  68          void offBLUE()
  69          {
  70   1        P1 &= 0xF7;
  71   1      }
  72          void onYELLOW()
  73          {
  74   1        for(i = 0; i < 2; i++)
  75   1        {
  76   2          if(i==0)
  77   2          {
  78   3            onRED();
  79   3          }
  80   2          else
  81   2          {
  82   3            onGREEN();
  83   3          }
  84   2        }
  85   1      }
  86          void onCYAN()
  87          {
  88   1        for(i = 0; i < 2; i++)
  89   1        {
  90   2          if(i==0)
  91   2          {
  92   3            onBLUE();
  93   3          }
  94   2          else
  95   2          {
  96   3            onGREEN();
  97   3          }
  98   2        }
  99   1      }
 100          
 101          void onWHITE()
 102          {
 103   1        for(i = 0; i < 3; i++)
 104   1        {
 105   2          if(i==0)
 106   2          {
 107   3            onRED();
 108   3          }
 109   2          else if(i==1)
 110   2          {
 111   3            onGREEN();
 112   3          }
 113   2          else
 114   2          {
 115   3            onBLUE();
 116   3          }
 117   2        }
C51 COMPILER V9.60.0.0   MAIN                                                              08/11/2021 17:30:44 PAGE 3   

 118   1      }
 119          
 120          ///////////////////////////////////
 121          
 122          ////////RELAY//////////////////////
 123          void onRELAY()
 124          {
 125   1        P1 |= 0x20;
 126   1        onRED();
 127   1      }
 128          void offRELAY()
 129          {
 130   1        P1 &= 0xDF;
 131   1        onBLUE();
 132   1      }
 133          //////////////////////////////////////
 134          
 135          void main()
 136          {
 137   1        cli();            // disable INT. during peripheral setting
 138   1        port_init();      // initialize ports
 139   1        clock_init();     // initialize operation clock
 140   1        sei();            // enable INT.
 141   1        
 142   1        // TODO: add your main code here
 143   1        T0CR = 0x90; // Timer 0 Control Register - PWM Mode P35
 144   1        controlPWM(2);
 145   1        while(1)
 146   1        {
 147   2          //onWHITE();
 148   2          //P1 |= 0x0E;
 149   2          //P3 = 0x20;
 150   2          //controlPWM(1);
 151   2          //controlPWM(2);
 152   2          //controlPWM(3);
 153   2          //controlPWM(1);
 154   2        }
 155   1      }
 156          
 157          //======================================================
 158          // interrupt routines
 159          //======================================================
 160          
 161          //======================================================
 162          // peripheral setting routines
 163          //======================================================
 164          
 165          void clock_init()
 166          {
 167   1        // internal RC clock (1.000000MHz)
 168   1        // Nothing to do for the default clock
 169   1      }
 170          
 171          void port_init()
 172          {
 173   1        // initialize ports
 174   1        P0IO = 0xFF;      // direction
 175   1        P0PU = 0x00;      // pullup
 176   1        P0OD = 0x00;      // open drain
 177   1        P03DB = 0x00;     // bit7~6(debounce clock), bit5~0=P35,P06~02 debounce
 178   1        P0   = 0x00;      // port initial value
 179   1      
C51 COMPILER V9.60.0.0   MAIN                                                              08/11/2021 17:30:44 PAGE 4   

 180   1        P1IO = 0xFF;      // direction
 181   1        P1PU = 0x00;      // pullup
 182   1        P1OD = 0x00;      // open drain
 183   1        P12DB = 0x00;     // debounce : P23~20, P13~10
 184   1        P1   = 0x00;      // port initial value
 185   1      
 186   1        P2IO = 0xFF;      // direction
 187   1        P2PU = 0x00;      // pullup
 188   1        P2OD = 0x00;      // open drain
 189   1        P2   = 0x00;      // port initial value
 190   1      
 191   1        P3IO = 0xFF;      // direction
 192   1        P3PU = 0x00;      // pullup
 193   1        P3OD = 0x00;      // open drain
 194   1        P3   = 0x00;      // port initial value
 195   1      
 196   1        // Set port functions
 197   1        P0FSR = 0x00;     // P0 selection
 198   1        P1FSRH = 0x00;    // P1 selection High
 199   1        P1FSRL = 0x00;    // P1 selection Low
 200   1        P2FSR = 0x00;     // P2 selection
 201   1        P3FSR = 0x20;     // P3 selection P35 pwm mode
 202   1      }
 203          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    343    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =      8    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
